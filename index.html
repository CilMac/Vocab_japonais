<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ğŸ‡¯ğŸ‡µ Vocabulaire Japonais â€” Kit 400</title>
  <link rel="preload" as="fetch" href="voc_kit_400_top.json" crossorigin="anonymous">
  <link rel="preload" as="fetch" href="livreJaponais.json" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <noscript>Cette application nÃ©cessite JavaScript.</noscript>

  <header class="topbar" role="banner">
    <div class="selectors" role="group" aria-label="Filtres d'interrogation">
      <label for="mode-select" class="sr-only">Mode</label>
      <select id="mode-select" aria-label="Mode dâ€™interrogation">
        <option value="FranÃ§ais">FranÃ§ais â†’ (deviner JA)</option>
        <option value="Romaji">RÅmaji â†’ (deviner FR)</option>
        <option value="Kana">ã‹ãª â†’ (deviner FR)</option>
        <option value="Kanji">æ¼¢å­— â†’ (deviner FR)</option>
      </select>

      <label for="asavoir-select" class="sr-only">Importance</label>
      <select id="asavoir-select" aria-label="Filtre importance">
        <option value="__ALL__">Tous niveaux</option>
      </select>

      <label for="category-select" class="sr-only">CatÃ©gorie</label>
      <select id="category-select" aria-label="Filtre catÃ©gorie">
        <option value="__ALL__">Toutes catÃ©gories</option>
      </select>
    </div>

    <div class="voice-controls" role="group" aria-label="Voix japonaises">
      
      <button id="voice-preview-btn" aria-label="PrÃ©-Ã©coute de la voix sÃ©lectionnÃ©e" title="PrÃ©-Ã©coute">ğŸ”Š</button>
      <span id="voice-status" aria-live="polite" class="badge">DÃ©tection...</span>
    </div>
  </header>

  <main id="app" role="main">
    <div id="loading-indicator" class="loading">Chargementâ€¦</div>
    <div id="error-message" class="error" role="alert" hidden></div>

    <section class="card word-zone" aria-label="Zone du mot">
      <div id="word-display" aria-live="polite">â€”</div>
    </section>

    <section class="nav" role="navigation" aria-label="Navigation des cartes">
      <button id="prev-btn" aria-label="PrÃ©cÃ©dent">â—€ï¸</button>
      <button id="random-btn" aria-label="AlÃ©atoire">ğŸ²</button>
      <button id="next-btn" aria-label="Suivant">â–¶ï¸</button>
    </section>

    <section class="answer" aria-label="RÃ©ponse optionnelle">
      <input id="answer-input" type="text" inputmode="text" autocomplete="off" placeholder="Ta rÃ©ponse (optionnelle)" aria-label="Champ de rÃ©ponse (optionnel)" />
      <button id="verify-btn" aria-label="VÃ©rifier">VÃ©rifier</button>
      <span id="checkmark" aria-hidden="true" class="checkmark" hidden>âœ“</span>
      <span id="crossmark" aria-hidden="true" class="crossmark" hidden>âœ—</span>
    </section>

    <section class="audio" aria-label="Prononciation">
      <button id="audio-word-btn" aria-label="Prononcer le mot">Mot ğŸ”ˆ</button>
<button id="voiceToggle" aria-pressed="false" aria-label="Basculer voix femme / homme" title="Voix femme / homme">ğŸ‘©</button>
      <button id="audio-example-btn" aria-label="Prononcer lâ€™exemple">Exemple ğŸ”ˆ</button>
    </section>

    <section class="results" aria-label="RÃ©sultats">
      <div id="result-translations" class="card small"></div>
      <div id="result-example" class="card small"></div>
    </section>
  </main>

  <footer class="foot">
    <small>par CilMac :-)</small>
      <button id="info-btn" class="info-btn" aria-haspopup="dialog" aria-controls="instructions-modal" title="Instructions">â„¹ï¸</button>
      <button id="phrases-btn" class="info-btn" aria-haspopup="dialog" aria-controls="phrases-modal" title="Phrases du livre">Phrases</button>
  </footer>

  <script defer src="app.js"></script>

  <!-- Instructions modal (invisible until opened) -->
  <div id="instructions-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="instructions-title" hidden>
    <div class="modal-overlay" data-close-modal></div>
    <div class="modal-dialog" role="document" tabindex="-1">
      <header class="modal-header">
        <h2 id="instructions-title">Instructions</h2>
        <button id="modal-close-btn" class="modal-close" aria-label="Fermer">âœ•</button>
      </header>
      <div class="modal-body">
        <p>Objet de la page :</p>
        <p>Cette page affiche des cartes de vocabulaire japonais. SÃ©lectionne un mode (FranÃ§ais, RÅmaji, ã‹ãª, æ¼¢å­—) pour afficher un mot. Tu peux rÃ©pondre dans le champ et cliquer Â« VÃ©rifier Â» pour valider.</p>
        <p>Fonctionnement :</p>
        <ul>
          <li><strong>FranÃ§ais â†’</strong> affiche le franÃ§ais et tu dois saisir la lecture japonaise (rÅmaji/kana/kanji).</li>
          <li><strong>RÅmaji / ã‹ãª / æ¼¢å­— â†’</strong> affiche la forme choisie et tu dois deviner le FranÃ§ais.</li>
          <li>Boutons audio lisent le mot ou l'exemple en japonais si une voix JA est disponible. Sinon un MP3 fallback peut Ãªtre utilisÃ©.</li>
          <li>La touche <kbd>EntrÃ©e</kbd> dÃ©clenche uniquement le bouton Â« VÃ©rifier Â» lorsque le champ de rÃ©ponse est actif.</li>
          <li>Un son de victoire est jouÃ© si la rÃ©ponse est correcte (fichier <code>victory.mp3</code> requis dans le dossier).</li>
        </ul>
        <p>Raccourcis :</p>
        <ul>
          <li><kbd>â—€</kbd> PrÃ©cÃ©dent</li>
          <li><kbd>â–¶</kbd> Suivant</li>
          <li><kbd>ğŸ²</kbd> AlÃ©atoire</li>
        </ul>
      </div>
      <footer class="modal-footer">
        <button id="modal-ok-btn" class="modal-ok">OK</button>
      </footer>
    </div>
  </div>
  <!-- End Instructions modal -->

  <!-- Phrases modal -->
  <div id="phrases-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="phrases-title" hidden>
    <div class="modal-overlay" data-close-modal></div>
    <div class="modal-dialog" role="document" tabindex="-1">
      <header class="modal-header">
        <h2 id="phrases-title">Phrases du livre</h2>
        <button id="phrases-close-btn" class="modal-close" aria-label="Fermer">âœ•</button>
      </header>
      <div class="modal-body">
        <div class="phrases-controls" style="display:flex; gap:.5rem; align-items:center; margin-bottom:.5rem;">
          <label class="sr-only" for="lesson-select">LeÃ§on</label>
          <select id="lesson-select" aria-label="LeÃ§on"></select>
          <div style="margin-left:auto; display:flex; gap:.25rem;">
            <button id="phrases-prev" aria-label="PrÃ©cÃ©dent">â—€ï¸</button>
            <button id="phrases-next" aria-label="Suivant">â–¶ï¸</button>
            <button id="phrases-audio" aria-label="Lire la phrase">ğŸ”ˆ</button>
          </div>
        </div>
        <div id="phrase-view" class="card small">
          <div class="phrase-line lang-kanji"   id="ph-ja">â€”</div>
          <div class="phrase-line lang-kana"    id="ph-kana">â€”</div>
          <div class="phrase-line lang-romaji"  id="ph-romaji">â€”</div>
          <div class="phrase-line lang-fr"      id="ph-fr">â€”</div>
        </div>
        <div id="phrase-status" class="badge" style="margin-top:.5rem;">â€”</div>
      </div>
      <footer class="modal-footer">
        <button id="phrases-info-btn" class="modal-info" aria-haspopup="dialog" title="Infos sur les phrases" style="margin-right:auto">â„¹ï¸ Info</button>
        <button id="phrases-ok-btn" class="modal-ok">OK</button>
      </footer>
    </div>
  </div>
  <!-- End Phrases modal -->


  <!-- Phrases INFO modal -->
  <div id="phrases-info-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="phrases-info-title" hidden>
    <div class="modal-overlay" data-close-modal></div>
    <div class="modal-dialog" role="document" tabindex="-1">
      <header class="modal-header">
        <h2 id="phrases-info-title">Phrases du livre</h2>
        <button id="phrases-info-close" class="modal-close" aria-label="Fermer">âœ•</button>
      </header>
      <div class="modal-body">
        <p>Cette fenÃªtre affiche les phrases extraites de <code>livreJaponais.json</code>.</p>
        <p>Structure attendue par ligne&nbsp;: <code>lesson</code> (ex. N1), <code>line</code> (ex. S00, S01â€¦), <code>japanese</code>, <code>kana</code>, <code>romaji</code>, <code>french</code>.</p>
        <ul>
          <li><strong>S00</strong> sert de titre de leÃ§on et est maintenant affichÃ© par dÃ©faut Ã  la sÃ©lection.</li>
          <li>Navigation avec â—€ï¸ / â–¶ï¸. Barre dâ€™espace ou EntrÃ©e&nbsp;: lecture audio si disponible.</li>
        </ul>
        <p><strong>Avertissement</strong>&nbsp;: la traduction franÃ§aise peut Ãªtre approximative ou fantaisiste selon les sources. Ã€ utiliser comme aide rapide, pas comme rÃ©fÃ©rence dÃ©finitive.</p>
      </div>
      <footer class="modal-footer">
        <button id="phrases-info-ok" class="modal-ok">OK</button>
      </footer>
    </div>
  </div>
  <!-- End Phrases INFO modal -->
</body>
</html>